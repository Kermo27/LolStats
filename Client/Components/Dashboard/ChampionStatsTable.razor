<MudPaper Class="p-4 rounded-2xl bg-surface">
    <MudText Typo="Typo.h5" Class="mb-4 font-bold">Champion Stats</MudText>

    <MudTextField @bind-Value="_searchString"
                  Placeholder="Filter by champion..."
                  Adornment="Adornment.Start"
                  AdornmentIcon="@Icons.Material.Filled.Search"
                  Class="mb-4 w-full" />

    <MudTable Items="filteredStats"
              Hover="true"
              Dense="true"
              Bordered="true"
              Striped="true"
              Filter="FilterFunc"
              RowsPerPage="10"
              Breakpoint="Breakpoint.Sm"
              Class="rounded-xl overflow-hidden">
        <HeaderContent>
            <MudTh><MudTableSortLabel T="MatchStats" SortBy="@(s => s.Champion)">Champion</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel T="MatchStats" SortBy="@(s => s.Games)">Games</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel T="MatchStats" SortBy="@(s => s.Wins)">Wins</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel T="MatchStats" SortBy="@(s => s.WinRate)">WR %</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel T="MatchStats" SortBy="@(s => s.AvgKda)">Avg KDA</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel T="MatchStats" SortBy="@(s => s.AvgCsm)">Avg CS/min</MudTableSortLabel></MudTh>
        </HeaderContent>

        <RowTemplate>
            <MudTd DataLabel="Champion">@context.Champion</MudTd>
            <MudTd DataLabel="Games">@context.Games</MudTd>
            <MudTd DataLabel="Wins">@context.Wins</MudTd>
            <MudTd DataLabel="WR %">
                <MudText Class="@UiHelpers.GetWrColor(@context.WinRate)">
                    @context.WinRate.ToString("F1")%
                </MudText>
            </MudTd>
            <MudTd DataLabel="Avg KDA">@context.AvgKda.ToString("F2")</MudTd>
            <MudTd DataLabel="Avg CS/min">@context.AvgCsm.ToString("F2")</MudTd>
        </RowTemplate>

        <PagerContent>
            <MudTablePager />
        </PagerContent>
    </MudTable>
</MudPaper>

@code {
    [Parameter] public IEnumerable<MatchStats> Stats { get; set; } = Enumerable.Empty<MatchStats>();

    private string _searchString = string.Empty;

    private IEnumerable<MatchStats> filteredStats =>
        string.IsNullOrWhiteSpace(_searchString)
            ? Stats
            : Stats.Where(s => s.Champion.Contains(_searchString, StringComparison.OrdinalIgnoreCase));

    private bool FilterFunc(MatchStats stat) =>
        string.IsNullOrWhiteSpace(_searchString) ||
        stat.Champion.Contains(_searchString, StringComparison.OrdinalIgnoreCase);
}
