@inject IJSRuntime JS

<MudPaper Elevation="2" Class="py-3 px-4 mb-4 rounded-xl d-flex align-center gap-4 relative overflow-hidden">
    
    <div style="position: absolute; left: 0; top: 0; bottom: 0; width: 6px; background-color: var(--mud-palette-primary);"></div>

    <div class="d-flex gap-3 align-center ml-2">
        <MudAvatar Color="Color.Primary" Variant="Variant.Filled" Rounded="true" Size="Size.Medium">
            <MudIcon Icon="@Icons.Material.Filled.History" />
        </MudAvatar>
        <div>
            <MudText Typo="Typo.h6" Class="font-weight-bold" Style="line-height: 1.2;">Historia Meczów</MudText>
            <MudText Typo="Typo.caption" Color="Color.Secondary">Zarządzaj swoimi danymi</MudText>
        </div>
    </div>

    <MudSpacer />

    <MudStack Row Spacing="1" AlignItems="AlignItems.Center">
        
        <MudMenu Label="Dane" 
                 StartIcon="@Icons.Material.Filled.Save" 
                 EndIcon="@Icons.Material.Filled.KeyboardArrowDown" 
                 Variant="Variant.Outlined" 
                 Color="Color.Primary"
                 Size="Size.Small"
                 Class="rounded-lg">
            
            <MudMenuItem OnClick="OnExport" Icon="@Icons.Material.Filled.Download">
                Eksportuj do JSON
            </MudMenuItem>
            
            <MudMenuItem OnClick="TriggerImport" Icon="@Icons.Material.Filled.Upload">
                Importuj z pliku
            </MudMenuItem>
        </MudMenu>

        <MudDivider Vertical="true" FlexItem="true" Class="mx-2 my-1" />

        <MudTooltip Text="Wyczyść całą historię">
            <MudIconButton Icon="@Icons.Material.Filled.DeleteForever" 
                           Color="Color.Error" 
                           Variant="Variant.Filled"
                           OnClick="OnClear"
                           Size="Size.Medium"
                           Class="rounded-lg shadow-sm" />
        </MudTooltip>
        
        <InputFile id="fileInput" OnChange="HandleFileChange" style="display:none" />
    </MudStack>
</MudPaper>

@code {
    [Parameter] public EventCallback OnExport { get; set; }
    [Parameter] public EventCallback<InputFileChangeEventArgs> OnImport { get; set; }
    [Parameter] public EventCallback OnClear { get; set; }

    private async Task TriggerImport()
    {
        await JS.InvokeVoidAsync("triggerFileInput", "fileInput");
    }

    private async Task HandleFileChange(InputFileChangeEventArgs e)
    {
        await OnImport.InvokeAsync(e);
    }
}