<MudPaper Class="p-4 rounded-2xl bg-surface">
    <MudText Typo="Typo.h5" Class="mb-4 font-bold">Stats vs Enemy Support</MudText>

    <MudTextField @bind-Value="_searchString"
                  Placeholder="Filter by enemy support..."
                  Adornment="Adornment.Start"
                  AdornmentIcon="@Icons.Material.Filled.Search"
                  Class="mb-4 w-full" />

    <MudTable Items="filteredEnemies"
              Hover="true"
              Dense="true"
              Bordered="true"
              Striped="true"
              Filter="FilterFunc"
              RowsPerPage="10"
              Breakpoint="Breakpoint.Sm"
              Class="rounded-xl overflow-hidden">
        <HeaderContent>
            <MudTh><MudTableSortLabel T="EnemySupportStats" SortBy="@(s => s.Enemy)">Support</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel T="EnemySupportStats" SortBy="@(s => s.Games)">Games</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel T="EnemySupportStats" SortBy="@(s => s.Wins)">Wins</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel T="EnemySupportStats" SortBy="@(s => s.WinRate)">WR %</MudTableSortLabel></MudTh>
        </HeaderContent>

        <RowTemplate>
            <MudTd DataLabel="Support">@context.Enemy</MudTd>
            <MudTd DataLabel="Games">@context.Games</MudTd>
            <MudTd DataLabel="Wins">@context.Wins</MudTd>
            <MudTd DataLabel="WR %">
                <MudText Class="@UiHelpers.GetWrColor(@context.WinRate)">
                    @context.WinRate.ToString("F1")%
                </MudText>
            </MudTd>
        </RowTemplate>

        <PagerContent>
            <MudTablePager />
        </PagerContent>
    </MudTable>
</MudPaper>

@code {
    [Parameter] public IEnumerable<EnemySupportStats> Enemies { get; set; } = Enumerable.Empty<EnemySupportStats>();

    private string _searchString = string.Empty;

    private IEnumerable<EnemySupportStats> filteredEnemies => string.IsNullOrWhiteSpace(_searchString)
        ? Enemies
        : Enemies.Where(e => e.Enemy.Contains(_searchString, StringComparison.OrdinalIgnoreCase));

    private bool FilterFunc(EnemySupportStats e) =>
        string.IsNullOrWhiteSpace(_searchString) ||
        e.Enemy.Contains(_searchString, StringComparison.OrdinalIgnoreCase);
}
