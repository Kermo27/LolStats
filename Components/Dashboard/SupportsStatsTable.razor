<MudPaper Class="p-4 rounded-2xl bg-surface">
    <MudText Typo="Typo.h5" Class="mb-4 font-bold">Stats With Supports</MudText>

    <MudTextField @bind-Value="_searchString"
                  Placeholder="Filter by support..."
                  Adornment="Adornment.Start"
                  AdornmentIcon="@Icons.Material.Filled.Search"
                  Class="mb-4 w-full" />

    <MudTable Items="filteredSupports"
              Hover="true"
              Dense="true"
              Bordered="true"
              Striped="true"
              Filter="FilterFunc"
              RowsPerPage="10"
              Breakpoint="Breakpoint.Sm"
              Class="rounded-xl overflow-hidden">

        <HeaderContent>
            <MudTh><MudTableSortLabel T="SupportStats" SortBy="@(s => s.Support)">Support</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel T="SupportStats" SortBy="@(s => s.Games)">Games</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel T="SupportStats" SortBy="@(s => s.Wins)">Wins</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel T="SupportStats" SortBy="@(s => s.WinRate)">WR %</MudTableSortLabel></MudTh>
            <MudTh><MudTableSortLabel T="SupportStats" SortBy="@(s => s.AvgKda)">Avg KDA</MudTableSortLabel></MudTh>
        </HeaderContent>

        <RowTemplate>
            <MudTd DataLabel="Support">@context.Support</MudTd>
            <MudTd DataLabel="Games">@context.Games</MudTd>
            <MudTd DataLabel="Wins">@context.Wins</MudTd>
            <MudTd DataLabel="WR %">
                <MudText Class="@UiHelpers.GetWrColor(@context.WinRate)">
                    @context.WinRate.ToString("F1")%
                </MudText>
            </MudTd>
            <MudTd DataLabel="Avg KDA">@context.AvgKda.ToString("F2")</MudTd>
        </RowTemplate>

        <PagerContent>
            <MudTablePager />
        </PagerContent>
    </MudTable>
</MudPaper>

@code {
    [Parameter] public IEnumerable<SupportStats> Supports { get; set; } = Enumerable.Empty<SupportStats>();

    private string _searchString = string.Empty;

    private IEnumerable<SupportStats> filteredSupports => string.IsNullOrWhiteSpace(_searchString)
        ? Supports
        : Supports.Where(s => s.Support.Contains(_searchString, StringComparison.OrdinalIgnoreCase));

    private bool FilterFunc(SupportStats s) =>
        string.IsNullOrWhiteSpace(_searchString) ||
        s.Support.Contains(_searchString, StringComparison.OrdinalIgnoreCase);
}
