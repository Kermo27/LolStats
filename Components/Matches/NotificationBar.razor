@namespace LolStatsTracker.Components.Matches

@if (!string.IsNullOrWhiteSpace(ErrorMessage))
{
    <div class="bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-lg mb-6">
        <span class="font-bold">Błąd:</span> @ErrorMessage
        <button class="float-right font-bold" @onclick="ClearError">✖</button>
    </div>
}

@if (!string.IsNullOrWhiteSpace(SuccessMessage))
{
    <div class="bg-green-900/50 border border-green-700 text-green-200 px-4 py-3 rounded-lg mb-6">
        @SuccessMessage
        <button class="float-right font-bold" @onclick="ClearSuccess">✖</button>
    </div>
}

@code {
    [Parameter] public string? ErrorMessage { get; set; }
    [Parameter] public EventCallback OnErrorCleared { get; set; }
    
    [Parameter] public string? SuccessMessage { get; set; }
    [Parameter] public EventCallback OnSuccessCleared { get; set; }
    
    protected override async Task OnParametersSetAsync()
    {
        if (!string.IsNullOrWhiteSpace(ErrorMessage))
            await Task.Delay(5000).ContinueWith(_ => ClearError());

        if (!string.IsNullOrWhiteSpace(SuccessMessage))
            await Task.Delay(3000).ContinueWith(_ => ClearSuccess());
    }
    
    private async Task ClearError()
    {
        await OnErrorCleared.InvokeAsync();
    }

    private async Task ClearSuccess()
    {
        await OnSuccessCleared.InvokeAsync();
    }
}